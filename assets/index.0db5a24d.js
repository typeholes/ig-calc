var e=Object.defineProperty,t=(t,s,a)=>(((t,s,a)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a})(t,"symbol"!=typeof s?s+"":s,a),a);import{_ as s,p as a,a as i,s as n,d as r,r as o,b as l,u as c,o as u,c as h,e as d,t as m,n as g,f as p,g as f,F as y,h as v,i as b,j as S,k as M,l as N,K as V,m as k,q as x}from"./vendor.1e377b73.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const _=function(e){return e.name&&(e.toTex=()=>"\\class{hover varname-"+e.name+"}{"+e.name+"}"),e};function w(e,t){const s=e.indexOf(t);-1!==s&&e.splice(s,1)}function F(e){return e.filter(((e,t,s)=>s.indexOf(e)===t))}function C(e,t=8){if("number"!=typeof e)return e;return(e>1e3?e.toExponential(2):e.toFixed(2)).toString().replace("+","").padStart(t," ")}var D,U;D={x:1},U=e=>"a",Object.fromEntries(Object.entries(D).map((([e,t],s,a)=>[e,U(t)])));const j=a();function B(e,t){j.set(e,t)}function T(e,t,s={},a=Number.MAX_SAFE_INTEGER,n=1){if(e.content)return e.content=T(e.content,t,s,a,n+1),e;if(e.op)return e.args=e.args.map((e=>T(e,t,s,a,n+1))),e;if(e.fn){let h=R.get(e.fn);if(void 0===h||n>a)return e.args=e.args.map((e=>T(e,t,s,a,n))),e;for(var r=i(h.body),o={},l=0;l<h.argNames.length;l++){var c=h.argNames[l],u=e.args[l];o[c]=T(u,t,{...s},a,n+1)}return T(r,t,{...s,...o},a,n+1)}if(e.name){const a=s[e.name],n=t?a||j.get(e.name):a;if(void 0===n)try{const t=e.evaluate();return"number"==typeof t?i(t.toString()):e}catch(h){return e}return"object"==typeof n?n:i(n)}return e.value,e}function A(e){var t="Not Run";try{t=j.evaluate(e)}catch(s){t=s}return t}function E(e,t,s,a={}){return function(){let r=i(e),o=t?T(r,s,a):r;return n(o).transform(_).toTex({parenthesis:"keep",implicit:"hide"})}}function O(e,t,s={}){return function(){return function(e,t,s={}){var a=T(e,!0,s);return r(a,t)}(e,t,s).transform(_).toTex({parenthesis:"keep",implicit:"hide"})}}function I(e,t={}){return F(T(i(e),!1,t).filter((function(e){return e.isSymbolNode&&void 0!==j.get(e.name)})).map((e=>e.name)))}function q(e,t="",a="",n="",r,o={}){void 0!==t&&""!==t&&function(e,t,s="",a={}){!function(e){const t=e.map((e=>{var t=document.getElementById(e.id),s=e.toTex();return MathJax.tex2chtmlPromise(s,{em:64,ex:16,display:!1,scale:2}).then((e=>{t&&(t.innerHTML="",t.appendChild(e))}))}));MathJax.typesetClear(),Promise.all(t).then(MathJax.typesetPromise()).then(createHovers)}([{id:s+"pretty",toTex:E(e,!1,!1)},{id:s+"pretty-val",toTex:E(e,!0,!1,a)},{id:s+"derivative",toTex:O(e,t)},{id:s+"derivative-val",toTex:O(e,t,a)}])}(e.body,"x",t,o);const l=e.body,c=T(i(l),!0,o),u=F(c.filter((function(e){return e.isSymbolNode&&void 0!==j.get(e.name)})).map((e=>e.name)));if(u.length>1)throw"too many free variables in "+e.name+": "+u.join(", ");const h=u[0];!function(e,t,a){s({target:e,title:a,width:300,yAxis:{domain:[-1,9]},grid:!0,data:[{fn:t,color:"purple",graphType:"polyline"}],tip:{renderer:function(e,t,s){return t.toString()}}})}(a,("x"===h?"":h+"=x;")+c.toString(),(r[h]||h)+" -> "+n)}class G{constructor(e,s,a){t(this,"name"),t(this,"argNames"),t(this,"body"),t(this,"_fn"),this.name=e,this.argNames=s,this.body=a,this._fn=function(e){var t="Valid",s=null;try{s=j.evaluate(e)}catch(a){t=a}return{result:t,fn:s}}(this.defString()).fn}evalArgValues(e){return this.argNames.map((t=>A(e[t])))}argValues(e){return this.argNames.map((t=>e[t]))}signatureString(){return this.name+"("+this.argNames.join(",")+")"}defString(){return this.signatureString()+" = "+this.body}run(e){return this._fn(...this.evalArgValues(e))}callStr(e){return this.name+"("+this.argValues(e).join(",")+")"}callStrEvaluatedArgs(e){return this.name+"("+this.evalArgValues(e).join(",")+")"}}const P=class{constructor(){t(this,"map",{});const e=new G("id",["x"],"x");this.map.id=e}static add(e){P._instance.map[e.name]=e}static get(e){return P._instance.map[e]}static create(e,t,s){const a=new G(e,t,s);return P.add(a),a}static adjust(e,t,s){return this.create(t,e.argNames,s(e.body))}static makeUniqueSuffix(){this.uniqCnt++;return this.uniqCnt.toString().split("").map((e=>this.digitMap[e])).join("")+"_"}};let R=P;t(R,"_instance",new P),t(R,"uniqCnt",0),t(R,"digitMap",{1:"a",2:"b",3:"c",4:"d",5:"e",6:"f",7:"g",8:"h",9:"i",0:"j",".":"k","+":"l","-":"m",",":"n",e:"o"});class J{constructor(e,s,a,i,n){t(this,"name"),t(this,"displayName"),t(this,"visible"),t(this,"fn"),t(this,"args"),this.name=e,this.displayName=s,this.visible=a,this.fn=i,this.args=n}get value(){return this.fn.run(this.args)}spend(e){}dependsOn(e){return!(void 0===Object.values(this.args).find((t=>"string"==typeof t&&t.split(/[^a-zA-Z]/).includes(e))))}}const L=class extends J{constructor(){super("t","Time",!1,R.get("id"),{x:"t"}),t(this,"time",0)}get value(){return this.time}};let W=L;t(W,"instance",new L);class z extends J{}class Z extends J{constructor(e,s,a,i,n,r,o,l=i,c=n,u=!0){super(e,s,a,i,n),t(this,"_cntBought",0),t(this,"_totalBought",0),t(this,"currency"),t(this,"buyable",!0),t(this,"sellable",!1),t(this,"sellFn"),t(this,"sellArgs"),this.currency=r,this.sellable=o,this.buyable=u,this.sellFn=l,this.sellArgs=c}forceSetCounts(e,t){this._cntBought=e,this._totalBought=t}get cost(){return super.value}get sellCost(){return this.sellFn.run(this.sellArgs)}get value(){return this._cntBought}get totalBought(){return this._totalBought}buy(){this._cntBought++,this._totalBought++}spend(e){this._cntBought-=e}}class H extends Z{constructor(e,t,s){const a=R.get("id"),i={x:e};super(e,t,s,a,i,"",!1,a,i,!1)}}class K{constructor(){t(this,"buffer",[{actions:[],delay:0}]),t(this,"priorityActions",[]),t(this,"delay",0)}tick(){const e=this.priorityActions;if(this.priorityActions=[],e.forEach((e=>e())),this.delay>0)return void this.delay--;if(this.buffer.length<1)return;const{actions:t,delay:s}=this.buffer.shift();this.delay=s,t.forEach((e=>e()))}asap(...e){this.priorityActions.push(...e)}schedule(e,t=0,s=0){const a=Array.isArray(e)?e:[e];this.buffer.length<1&&this.buffer.push({actions:[],delay:0});const i=this.buffer[this.buffer.length-1];i.delay<1&&s<1?(i.actions.push(...a),i.delay=t):(i.delay<s&&(i.delay=s),this.buffer.push({actions:a,delay:t}))}}const Y={value:0,cost:0,sellCost:0,total:0};class X{constructor(e,s,a){t(this,"uiState"),t(this,"uiStateMethods"),t(this,"milestoneManager"),t(this,"_items",{t:W.instance}),t(this,"_order",[]),t(this,"_dependencies",{}),t(this,"_deepDependencies",{}),t(this,"_dirty",[]),t(this,"_tickBuffer",new K),this.uiState=e,this.uiStateMethods=s,this.milestoneManager=a,this.add(W.instance)}getUiVarField(e,t){const s="string"==typeof e?this.get(e):e;return"value"===t?s.value:"total"===t&&s instanceof Z?s.totalBought:"cost"===t&&s instanceof Z?s.cost:"sellCost"===t&&s instanceof Z?s.sellCost:NaN}setUiVarField(e,t,s=NaN){const a="string"==typeof e?this.get(e):e;"dirty"===s&&this._dirty.push(a.name);let i=s;("dirty"==i||isNaN(i))&&(i=this.getUiVarField(a,t)),this.uiStateMethods.varSetter(this.uiState,a.name,t,i),"value"!==t&&"total"!==t||(B(a.name+("total"===t?"_total":""),i),this.handleMilestoneUpdate(a.name))}setUiVarFields(e,t="clean"){const s="string"==typeof e?this.get(e):e;"dirty"===t&&this._dirty.push(s.name),this.setUiVarField(s,"cost"),this.setUiVarField(s,"sellCost"),this.setUiVarField(s,"value"),this.setUiVarField(s,"total")}newCalculation(e,t,s,a,i){const n=new z(e,t,s,a,i);return this.add(n),n}newPlain(e,t,s,a){const i=new H(e,t,s);return this.add(i),i.spend(-1*a),i}newBuyable(e,t,s,a,i,n,r){const o=new Z(e,t,s,a,i,n,r);this.add(o),this.setUiVarField(o,"value"),this.setUiVarField(o,"cost");const l=this._items[n];return l instanceof z&&(l.fn=R.adjust(l.fn,e+"_"+n,(t=>t+" - "+a.callStr(i).replace(e,e+"_total")+" + "+a.callStrEvaluatedArgs(i)))),this.setUiVarField(l,"value","dirty"),o}add(e){var t,s;this.uiStateMethods.varAdder(this.uiState,e.name),this._dependencies[e.name]=[],this._calculateDependencies(e),this._deepDependencies[e.name]=(t=e.fn,s=e.args,t?I(t.body,s):[]),this._order.push(e.name),this._items[e.name]=e,this.setUiVarField(e,"value","dirty")}_calculateDependencies(e){for(const t in this._items)e.dependsOn(t)&&this._dependencies[t].push(e.name)}get(e){return this._items[e]}getNames(){return[...this._order]}asap(...e){this._tickBuffer.asap(...e)}schedule(e,t=0,s=0){this._tickBuffer.schedule(e,t,s)}tick(e){const t=this._items.t;t.time+=e,this.setUiVarField(t,"value",t.time),this._dirty.push("t");for(let s=0;s<2;s++){const e=[];this._order.forEach((t=>{if(this._dirty.includes(t)){const s=this._items[t];this.setUiVarFields(s),this._dirty.push(...this._dependencies[t]),e.push(t)}this._dirty=F(this._dirty),e.forEach((e=>{w(this._dirty,e)}))}))}this._tickBuffer.tick()}isBuyable(e){const t=this.get(e);return t instanceof Z&&t.buyable}isSellable(e){const t=this.get(e);return t instanceof Z&&t.sellable}getDependencies(e){const t=this._deepDependencies[e]||[],s=t.map((e=>this.getDependencies(e))).flat();return t.push(...s),t}getDependents(e){const t=[];return this._order.forEach((s=>{this._deepDependencies[s].includes(e)&&t.push(s)})),t}getCurrency(e){const t=this.get(e);if(t instanceof Z)return this.get(t.currency)}getCurrencyName(e){const t=this.getCurrency(e);return t?t.name:""}sell(e){const t=this.get(e);if(!(t instanceof Z))return;const s=this.getCurrencyName(e),a=this.get(s),i=t.cost;t.spend(1),this.setUiVarFields(t,"dirty"),a.spend(-1*i),this.setUiVarFields(a,"dirty")}buy(e){const t=this.get(e);if(!(t instanceof Z))return;const s=this.getCurrencyName(e),a=this.get(s),i=t.cost;i>this.getUiVarField(a,"cost")||(t.buy(),this.setUiVarFields(t,"dirty"),a.spend(i),this.setUiVarFields(a,"dirty"))}setFromUIValues(){this._order.forEach((e=>{const t=this._items[e];t instanceof Z?t.forceSetCounts(this.uiStateMethods.varGetter(this.uiState,e,"value"),this.uiStateMethods.varGetter(this.uiState,e,"total")):t instanceof W&&(t.time=this.uiStateMethods.varGetter(this.uiState,e,"value")),this._dirty.push(e),B(e,this.uiStateMethods.varGetter(this.uiState,e,"value")),B(e+"_total",this.uiStateMethods.varGetter(this.uiState,e,"value")),this.handleMilestoneUpdate(e)}))}handleMilestoneUpdate(e){this.milestoneManager.handleUpdate(e).forEach((e=>{if(e.setVisible)for(let t in e.setVisible){this.get(t).visible=!0}if(e.setBuyable)for(let t in e.setBuyable){const e=this.get(t);e instanceof Z&&(e.buyable=!0)}if(e.setSellable)for(let t in e.setSellable){const e=this.get(t);e instanceof Z&&(e.sellable=!0)}if(e.adjustFunctions)for(let t in e.adjustFunctions)for(let s in e.adjustFunctions[t]){const a=e.adjustFunctions[t][s];this.adjustFnOf(t,s,a,"M")}}))}adjustFnOf(e,t,s,a){const i=this.get(e),n="_"+a+R.makeUniqueSuffix();let r,o;if("value"!==t||i instanceof Z)if("cost"===t&&i instanceof Z)r=i.fn,o=e=>i.fn=e;else{if(!("sellCost"===t&&i instanceof Z))throw"invalid fnType "+t+" for "+i.name;r=i.sellFn,o=e=>i.sellFn=e}else r=i.fn,o=e=>i.fn=e;o(R.adjust(r,r.name+n,(e=>s.replace("<&>",r.signatureString()))))}getDisplayExpr(e){const t=this._order.map((e=>[e,this.get(e).displayName]));return function(e,t){return i(e).transform((function(e,s,a){return e.isSymbolNode&&t[e.name]?i('"'+t[e.name]+'"'):e})).toString()}(e,Object.fromEntries(t))}}class ${constructor(e){t(this,"saves",{}),t(this,"uiStateGetter"),this.uiStateGetter=e;const s=window.localStorage.getItem("matholeSaves");s?this.parseSaveStr(s):this.save("default")}save(e){this.buildNewSave(e),this.writeSaves()}load(e){return this.saves[e]}readSave(e){return!1}parseSaveStr(e){this.saves=JSON.parse(e)}writeSaves(){const e=JSON.stringify(this.saves);window.localStorage.setItem("matholeSaves",e)}buildNewSave(e){this.saves[e]=this.uiStateGetter()}}class Q{constructor(e,s,a,i="",n={}){t(this,"name"),t(this,"displayName"),t(this,"rewardtext"),t(this,"condition"),t(this,"rewardAction"),this.name=e,this.displayName=s,this.rewardtext=i,this.condition=a,this.rewardAction=n}check(){return A(this.condition)}}class ee{constructor(e,s){t(this,"milestoneMap",{}),t(this,"dependencies",{}),t(this,"uiState"),t(this,"uiStateMethods"),this.uiState=e,this.uiStateMethods=s}create(e,t,s,a="",i={}){const n=new Q(e,t,s,a,i);this.milestoneMap[e]=n;return I(s).forEach((t=>{var s;(s=this.dependencies)[t]||(s[t]=[]),this.dependencies[t].push(e)})),n}handleUpdate(e){const t=this.dependencies[e];if(!t)return[];const s=[];return t.forEach((e=>{if(this.milestoneReached(e))return;const t=this.milestoneMap[e];t.check()&&(this.setReached(e),s.push(t.rewardAction),ae.instance.callbacks.milestoneReached(t.name,t.rewardAction.storyPoint))})),s}milestoneReached(e){return this.uiStateMethods.milestoneGetter(this.uiState,e)}setReached(e){this.uiStateMethods.milestoneSetter(this.uiState,e,!0)}getNames(){return Object.keys(this.milestoneMap)}get(e){return this.milestoneMap[e]}}function te(...e){}const se=class{constructor(e,s,a,i){var n;t(this,"canTick",!1),t(this,"callbacks"),t(this,"hasStarted",!1),t(this,"gameVarManager"),t(this,"saveManager"),t(this,"milestoneManager"),t(this,"uiState"),t(this,"uiStateMethods"),this.uiState=e,this.uiStateMethods=s,this.callbacks=i;for(let t in i)(n=this.callbacks)[t]||(n[t]=te);this.milestoneManager=new ee(e,s),this.gameVarManager=new X(e,s,this.milestoneManager),a(this.gameVarManager,R,this.milestoneManager),this.saveManager=new $((()=>this.uiStateMethods.cloner(this.uiState)))}static init(e,t,s,a){return se._instance=new se(e,t,s,a),e}static getInstance(){return se._instance}start(){this.hasStarted||(this.hasStarted=!0,this.canTick=!0)}asap(...e){this.gameVarManager.asap(...e)}schedule(e,t=0,s=0){this.gameVarManager.schedule(e,t,s)}displayFunction(e,t,s,a){const i=this.gameVarManager.get(e);q(i.fn,"",t,a,s,i.args)}getNameMap(){const e={};return this.gameVarManager.getNames().forEach((t=>e[t]=this.getDisplayName(t))),e}getNames(){return this.gameVarManager.getNames()}tick(e){this.canTick&&(this.canTick=!1,this.gameVarManager&&this.gameVarManager.tick(e),this.canTick=!0)}getDisplayName(e){return""===e?"WTF!":this.gameVarManager.get(e).displayName}isVisible(e){return this.gameVarManager.get(e).visible}buy(e){this.gameVarManager.buy(e)}sell(e){this.gameVarManager.sell(e)}isSellable(e){return this.gameVarManager.isSellable(e)}isBuyable(e){return this.gameVarManager.isBuyable(e)}getCurrencyName(e){return this.gameVarManager.getCurrencyName(e)}getCurrencyDisplayName(e){return""===e?"":this.getDisplayName(this.getCurrencyName(e))}getDependencies(e){return this.gameVarManager.getDependencies(e)}getDependents(e){return this.gameVarManager.getDependents(e)}getMilestoneNames(){return this.milestoneManager.getNames()}getMilestoneDisplayName(e){return e?this.milestoneManager.get(e).displayName:""}getMilestoneReward(e){return e?this.milestoneManager.get(e).rewardtext:""}getMilestoneCondition(e){if(!e)return"";const t=this.milestoneManager.get(e).condition;return this.getDisplayExpr(t)}getDisplayExpr(e){return this.gameVarManager.getDisplayExpr(e)}save(){this.canTick=!1,this.saveManager.save("default"),this.canTick=!0}load(){this.canTick=!1;const e=this.saveManager.load("default").vars;for(const t in e){const s=e[t].value,a=e[t].cost,i=e[t].cost,n=e[t].total;this.gameVarManager.setUiVarField(t,"value",s),this.gameVarManager.setUiVarField(t,"cost",a),this.gameVarManager.setUiVarField(t,"sellCost",i),this.gameVarManager.setUiVarField(t,"total",n)}this.gameVarManager.setFromUIValues(),this.canTick=!0}static get instance(){return se._instance}};let ae=se;t(ae,"_instance");let ie=null,ne=null;function re(){return Object.keys(ie)}function oe(){return e=he.sidebarMode,ie[e]||ie.Sidebars;var e}let le=["Sidebars"];function ce(){0!=le.length?ue(le.pop(),!1):ue("Sidebars",!1)}function ue(e,t=!0){t&&"Sidebars"!==he.sidebarMode&&le.push(he.sidebarMode),le.length>20&&le.splice(0,le.length-20),he.sidebarMode=e}const he=o({graphedVarName:"",selectedVarName:"",dependencies:[],dependents:[],sidebarMode:"Story"}),de=o({vars:{},milestones:{}}),me={cloner:e=>e,varAdder:(e,t)=>e.vars[t]=o({...Y}),varGetter:(e,t,s)=>e.vars[t][s],varSetter:(e,t,s,a)=>e.vars[t][s]=a,milestoneGetter:(e,t)=>e.milestones[t],milestoneSetter:(e,t,s)=>e.milestones[t]=s};function ge(e){return de.vars[e].value}function pe(e){return de.vars[e].sellCost}function fe(e){return de.vars[e].cost}function ye(e){return de.milestones[e]}function ve(e){if("Dependencies"===he.sidebarMode)if(he.selectedVarName===e)he.selectedVarName="",he.dependencies=[],he.dependents=[];else{he.selectedVarName=e;let t=ne.getDependencies(e),s=ne.getDependents(e);he.dependencies=t,he.dependents=s}"Graph"===he.sidebarMode&&(he.graphedVarName=e,be())}function be(){var e;""!==he.graphedVarName&&ne.displayFunction(he.graphedVarName,"#test-graph-expr",ne.getNameMap(),(e=he.graphedVarName,(ne.isBuyable(e)?"Cost of ":"")+ne.getDisplayName(e)))}const Se={milestoneReached:[function(e,t){ne.schedule((()=>{ue("Story")})),t||ne.schedule((()=>{"Story"===he.sidebarMode&&ce()}),0,2)},[]],something:[e=>{},[]]};let Me=function(){const e=Object.keys(Se).map((e=>{return[e,(t=e,(...e)=>{const[s,a]=Se[t];!function(e,...t){return(...s)=>{e(...s),t.forEach((e=>e(...s)))}}(s,...a)(...e)})];var t}));return Object.fromEntries(e)}();const Ne={key:0,class:"gamevar"},Ve={class:"label"},ke={class:"value"},xe={class:"buy"},_e=["disabled"],we={class:"sell"},Fe=["disabled"];var Ce=l({props:{varName:{type:String,required:!0},forceVisible:{type:Boolean,required:!1,default:!1}},setup(e){const t=ae.getInstance();function s(e){const s=t.getCurrencyName(e);if(!s)return!1;return ge(s)>=fe(e)}function a(e){let t={marker:!0,dependent:!1,depends:!1,hidden:!0,inline:!0};return e===he.selectedVarName?(t.hidden=!1,t):(he.dependencies.includes(e)&&(t.dependent=!0,t.hidden=!1),he.dependents.includes(e)&&(t.depends=!0,t.hidden=!1),t)}return(i,n)=>{return e.forceVisible||c(t).isVisible(e.varName)?(u(),h("div",Ne,[d("div",{class:g(a(e.varName))},[d("span",null,m(e.varName===c(he).selectedVarName?"⊜":"⇒"),1)],2),d("div",Ve,[d("span",{onClick:n[0]||(n[0]=t=>c(ve)(e.varName))},m(c(t).getDisplayName(e.varName))+": ",1)]),d("div",ke,m(c(C)(c(ge)(e.varName))),1),d("div",xe,[c(t).isBuyable(e.varName)?(u(),h("button",{key:0,onClick:n[1]||(n[1]=s=>{return a=e.varName,t.buy(a),void be();var a}),disabled:!s(e.varName)}," Buy: "+m(c(C)(c(fe)(e.varName)))+" "+m(c(t).getCurrencyDisplayName(e.varName)),9,_e)):p("",!0)]),d("div",we,[c(t).isSellable(e.varName)?(u(),h("button",{key:0,onClick:n[2]||(n[2]=s=>{return a=e.varName,t.sell(a),void be();var a}),disabled:(r=e.varName,!(ge(r)>0))},"Sell: "+m(c(C)(c(pe)(e.varName)))+" "+m(c(t).getCurrencyDisplayName(e.varName)),9,Fe)):p("",!0)])])):p("",!0);var r}}});const De={class:"game"},Ue={class:"mainVar"},je={class:"vars"},Be={class:"contents"};var Te=l({setup(e){const t=ae.getInstance();return(e,s)=>(u(),h("div",De,[d("div",Ue,[f(Ce,{varName:"t",forceVisible:""}),f(Ce,{varName:"money",forceVisible:""})]),d("div",je,[(u(!0),h(y,null,v(c(t).getNames(),(e=>(u(),h("div",Be,[f(Ce,{varName:e},null,8,["varName"])])))),256))])]))}});function Ae(e,t,s){const a=t.get("id"),i=t.create("times",["x","b"],"x*b");t.create("reciprical",["x"],"1/(x+1)"),t.create("zigZag",["x"],"1-2 * acos((1- smoother) * sin(2 * pi * x))/pi"),t.create("squareWave",["x"],"2 * atan( sin(2 * pi * x)/ smoother )/pi"),t.create("sawtooth",["x"],"(1+zigZag((2 * x - 1)/4) * squareWave(x/2))/2"),t.create("steps",["x"],"x - sawtooth(x)"),t.create("logSquares",["x","b"],"log(x^2+b^2)"),t.create("curvedSawtooth",["x"],"logSquares(x^smoother,sawtooth(x))");const n=t.create("calcMarketValue",["x"],"curvedSawtooth(x)*(marketScale+1)");e.newPlain("money","$",!1,1),e.newBuyable("stability","Market Stability",!0,i,{x:1.25,b:"stability+2/1.25"},"money",!1),e.newBuyable("marketScale","Market Scale",!0,i,{x:2,b:"marketScale+1"},"stability",!1),e.newCalculation("smoother","Smoother",!1,i,{x:"stability",b:.01}),e.newCalculation("marketValue","Market Value",!0,n,{x:"t"}),e.newBuyable("shares","Shares",!0,a,{x:"marketValue"},"money",!0),s.create("startStory","Went Bankrupt","t > 0","You start the game from scratch",{storyPoint:'You went bankrupt. All you have left is your library card and a dollar\'s worth of coins you found in the gutter. Time to head to the library, grab a computer, and login to jankyMarketTrader.com\n\n Warning: this is just a preview release so there will likely be bugs\n There is no auto save. Use the save and load buttons\n It is possible to price yourself out of the market until you reach the "Too Stable?" milestone\n this is intended to force some strategic play while the cost of having to restart is low'}),s.create("tooStable","Too Stable?","stability > 3"," Can sell Market Stability",{setSellable:{stability:!0},storyPoint:"It is harder to make money in stable markets. Maybe you should trade some of that stability to increase the scale of the market."}),s.create("scaled","Insider Trading","marketScale >= 1"," Better price when selling shares ",{adjustFunctions:{shares:{sellCost:" 1.1 * <&>"}}})}var Ee=l({setup(e){const t=ae.getInstance();return(e,s)=>(u(),h("div",null,[d("button",{onClick:s[0]||(s[0]=(...e)=>c(t).save&&c(t).save(...e))},"save"),d("button",{onClick:s[1]||(s[1]=(...e)=>c(t).load&&c(t).load(...e))},"load")]))}});const Oe=d("br",null,null,-1),Ie=d("br",null,null,-1);var qe=l({setup(e){const t=ae.getInstance();return(e,s)=>(u(),h("div",null,[b(" Dependencies: "+m(c(he).dependencies.map((e=>c(t).getDisplayName(e))).join(", "))+" ",1),Oe,Ie,b(" Dependents: "+m(c(he).dependents.map((e=>c(t).getDisplayName(e))).join(", ")),1)]))}});const Ge={},Pe=[d("div",{id:"test-graph-expr",class:"graphDiv"},null,-1)];Ge.render=function(e,t){return u(),h("div",null,Pe)};const Re=d("br",null,null,-1),Je=d("hr",null,null,-1);var Le=l({props:{name:{type:String,required:!0}},setup(e){const t=ae.getInstance();return(s,a)=>(u(),h(y,null,[d("div",{class:g({milestone:!0,reached:c(ye)(e.name)})},[b(m(c(t).getMilestoneDisplayName(e.name))+": "+m(c(t).getMilestoneCondition(e.name)),1),Re,b(" "+m(c(t).getMilestoneReward(e.name)),1)],2),Je],64))}});const We={class:"milestones"},ze={class:"contents"};var Ze=l({setup(e){const t=ae.getInstance();return(e,s)=>(u(),h("div",We,[(u(!0),h(y,null,v(c(t).getMilestoneNames(),(e=>(u(),h("div",ze,[f(Le,{name:e},null,8,["name"])])))),256))]))}});const He={style:{"white-space":"pre-wrap"}};var Ke=l({setup(e){let t=o({milestoneName:"",storyPoint:""});var s;return s=(e,s)=>{t.milestoneName=e,t.storyPoint=s},Se["milestoneReached"][1].push(s),(e,s)=>(u(),h("div",null,[d("div",null,[f(Le,{name:c(t).milestoneName},null,8,["name"])]),d("span",He,m(c(t).storyPoint),1)]))}});const Ye={class:"contents"},Xe=["onClick"];var $e=l({setup:e=>(e,t)=>(u(!0),h(y,null,v(c(re)(),(e=>(u(),h("div",Ye,[d("div",null,[d("button",{onClick:t=>c(ue)(e)},m(e),9,Xe)])])))),256))});const Qe={class:"mathole"},et={class:"topBar"},tt={class:"sidebar"},st={class:"mainPain"};var at=l({setup(e){ae.init(de,me,Ae,Me);const t=ae.getInstance();ie={Options:Ee,Dependencies:qe,Graph:Ge,Milestones:Ze,Story:Ke,Sidebars:$e},ne=t;let s=0;function a(e){const i=e-s;t.canTick&&i>=500&&(t.tick(i/1e4),s=e),window.requestAnimationFrame(a)}return S((()=>{ne.start(),window.requestAnimationFrame(a)})),(e,t)=>(u(),h("div",Qe,[d("div",et,[d("button",{onClick:t[0]||(t[0]=e=>c(ce)())}," ←"),b(m(c(he).sidebarMode)+" ",1),d("button",{onClick:t[1]||(t[1]=e=>c(ue)("Sidebars"))}," ≡")]),d("div",tt,[(u(),M(V,null,[(u(),M(N(c(oe)())))],1024))]),d("div",st,[f(Te)])]))}});const it={setup(e){var t={};return k("appAddViewMap",(function(e,s,a,i=t){i[e]||(i[e]={}),i[e][s]=a})),k("appGetView",(function(e,s,a=t){return a[e][s]})),(e,t)=>(u(),M(at))}};window.global={},x(it).mount("#app");
